{"ast":null,"code":"import _classCallCheck from \"/home/hoangdev/Desktop/front.test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/hoangdev/Desktop/front.test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/home/hoangdev/Desktop/front.test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/home/hoangdev/Desktop/front.test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport React$1, { Component, createRef } from 'react';\nimport debounce$1 from 'lodash/debounce';\nimport { EventListener as EventListener$1 } from '../../../EventListener/EventListener.js';\nimport { classNames } from '../../../../utilities/css.js';\nimport { Popover as Popover$1 } from '../../../Popover/Popover.js';\nimport { Button as Button$1 } from '../../../Button/Button.js';\nimport styles from './ConnectedFilterControl.scss.js';\nimport { Item as Item$1 } from './components/Item/Item.js';\nvar FILTER_FIELD_MIN_WIDTH = 150;\n\nvar ConnectedFilterControl = /*#__PURE__*/function (_Component) {\n  _inherits(ConnectedFilterControl, _Component);\n\n  var _super = _createSuper(ConnectedFilterControl);\n\n  function ConnectedFilterControl() {\n    var _this;\n\n    _classCallCheck(this, ConnectedFilterControl);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    _this.state = {\n      availableWidth: 0,\n      proxyButtonsWidth: {}\n    };\n    _this.container = /*#__PURE__*/createRef();\n    _this.proxyButtonContainer = /*#__PURE__*/createRef();\n    _this.moreFiltersButtonContainer = /*#__PURE__*/createRef();\n    _this.handleResize = debounce$1(function () {\n      _this.measureProxyButtons();\n\n      _this.measureAvailableWidth();\n    }, 40, {\n      leading: true,\n      trailing: true,\n      maxWait: 40\n    });\n    return _this;\n  }\n\n  _createClass(ConnectedFilterControl, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.handleResize();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props = this.props,\n          children = _this$props.children,\n          rightPopoverableActions = _this$props.rightPopoverableActions,\n          rightAction = _this$props.rightAction,\n          auxiliary = _this$props.auxiliary,\n          _this$props$forceShow = _this$props.forceShowMorefiltersButton,\n          forceShowMorefiltersButton = _this$props$forceShow === void 0 ? true : _this$props$forceShow,\n          queryFieldHidden = _this$props.queryFieldHidden;\n      var actionsToRender = rightPopoverableActions != null ? this.getActionsToRender(rightPopoverableActions) : [];\n      var className = classNames(styles.ConnectedFilterControl, rightPopoverableActions && styles.right);\n      var shouldRenderMoreFiltersButton = forceShowMorefiltersButton || rightPopoverableActions && rightPopoverableActions.length !== actionsToRender.length;\n      var RightContainerClassName = classNames(styles.RightContainer, !shouldRenderMoreFiltersButton && styles.RightContainerWithoutMoreFilters, queryFieldHidden && styles.queryFieldHidden);\n      var rightMarkup = actionsToRender.length > 0 ? /*#__PURE__*/React$1.createElement(\"div\", {\n        className: RightContainerClassName\n      }, this.popoverFrom(actionsToRender)) : null;\n      var moreFiltersButtonContainerClassname = classNames(styles.MoreFiltersButtonContainer, actionsToRender.length === 0 && styles.onlyButtonVisible);\n      var rightActionMarkup = rightAction ? /*#__PURE__*/React$1.createElement(\"div\", {\n        ref: this.moreFiltersButtonContainer,\n        className: moreFiltersButtonContainerClassname\n      }, shouldRenderMoreFiltersButton && /*#__PURE__*/React$1.createElement(Item$1, null, rightAction)) : null;\n      var proxyButtonMarkup = rightPopoverableActions ? /*#__PURE__*/React$1.createElement(\"div\", {\n        className: styles.ProxyButtonContainer,\n        ref: this.proxyButtonContainer,\n        \"aria-hidden\": true\n      }, rightPopoverableActions.map(function (action) {\n        return /*#__PURE__*/React$1.createElement(\"div\", {\n          key: action.key,\n          \"data-key\": action.key\n        }, _this2.activatorButtonFrom(action, {\n          proxy: true\n        }));\n      })) : null;\n      var auxMarkup = auxiliary ? /*#__PURE__*/React$1.createElement(\"div\", {\n        className: styles.AuxiliaryContainer\n      }, auxiliary) : null;\n      return /*#__PURE__*/React$1.createElement(React$1.Fragment, null, proxyButtonMarkup, /*#__PURE__*/React$1.createElement(\"div\", {\n        className: styles.Wrapper\n      }, /*#__PURE__*/React$1.createElement(\"div\", {\n        className: className,\n        ref: this.container\n      }, children ? /*#__PURE__*/React$1.createElement(\"div\", {\n        className: styles.CenterContainer\n      }, /*#__PURE__*/React$1.createElement(Item$1, null, children)) : null, rightMarkup, rightActionMarkup, /*#__PURE__*/React$1.createElement(EventListener$1, {\n        event: \"resize\",\n        handler: this.handleResize\n      })), auxMarkup));\n    }\n  }, {\n    key: \"measureProxyButtons\",\n    value: function measureProxyButtons() {\n      if (this.proxyButtonContainer.current) {\n        var proxyButtonsWidth = {}; // this number is magical, but tweaking it solved the problem of items overlapping\n\n        var tolerance = 78;\n\n        if (this.proxyButtonContainer.current) {\n          Array.from(this.proxyButtonContainer.current.children).forEach(function (element) {\n            var buttonWidth = element.getBoundingClientRect().width + tolerance;\n            var buttonKey = element instanceof HTMLElement && element.dataset.key;\n\n            if (buttonKey) {\n              proxyButtonsWidth[buttonKey] = buttonWidth;\n            }\n          });\n        }\n\n        this.setState({\n          proxyButtonsWidth: proxyButtonsWidth\n        });\n      }\n    }\n  }, {\n    key: \"measureAvailableWidth\",\n    value: function measureAvailableWidth() {\n      if (this.container.current && this.moreFiltersButtonContainer.current) {\n        var containerWidth = this.container.current.getBoundingClientRect().width;\n        var moreFiltersButtonWidth = this.moreFiltersButtonContainer.current.getBoundingClientRect().width;\n        var filtersActionWidth = 0;\n        var filterFieldMinWidth = this.props.queryFieldHidden ? 0 : FILTER_FIELD_MIN_WIDTH;\n        var availableWidth = containerWidth - filterFieldMinWidth - moreFiltersButtonWidth - filtersActionWidth;\n        this.setState({\n          availableWidth: availableWidth\n        });\n      }\n    }\n  }, {\n    key: \"getActionsToRender\",\n    value: function getActionsToRender(actions) {\n      var remainingWidth = this.state.availableWidth;\n      var actionsToReturn = [];\n\n      for (var i = 0; remainingWidth > 0 && i < actions.length; i++) {\n        var action = actions[i];\n        var actionWidth = this.state.proxyButtonsWidth[action.key];\n\n        if (actionWidth <= remainingWidth) {\n          actionsToReturn.push(action);\n          remainingWidth -= actionWidth;\n        } else {\n          // When we can't fit an action, we break the loop.\n          // The ones that didn't fit will be accessible through the \"More filters\" button\n          break;\n        }\n      }\n\n      return actionsToReturn;\n    }\n  }, {\n    key: \"activatorButtonFrom\",\n    value: function activatorButtonFrom(action, options) {\n      var id = (options == null ? void 0 : options.proxy) ? undefined : \"Activator-\".concat(action.key);\n      return /*#__PURE__*/React$1.createElement(Button$1, {\n        onClick: action.onAction,\n        disclosure: true,\n        disabled: this.props.disabled || action.disabled,\n        id: id\n      }, action.content);\n    }\n  }, {\n    key: \"popoverFrom\",\n    value: function popoverFrom(actions) {\n      var _this3 = this;\n\n      return actions.map(function (action) {\n        return /*#__PURE__*/React$1.createElement(Item$1, {\n          key: action.key\n        }, /*#__PURE__*/React$1.createElement(Popover$1, {\n          active: action.popoverOpen,\n          activator: _this3.activatorButtonFrom(action),\n          onClose: action.onAction,\n          preferredAlignment: \"left\",\n          sectioned: true\n        }, action.popoverContent));\n      });\n    }\n  }]);\n\n  return ConnectedFilterControl;\n}(Component);\n\nexport { ConnectedFilterControl };","map":{"version":3,"sources":["/home/hoangdev/Desktop/front.test/node_modules/@shopify/polaris/dist/esm/components/Filters/components/ConnectedFilterControl/ConnectedFilterControl.js"],"names":["React$1","Component","createRef","debounce$1","EventListener","EventListener$1","classNames","Popover","Popover$1","Button","Button$1","styles","Item","Item$1","FILTER_FIELD_MIN_WIDTH","ConnectedFilterControl","args","state","availableWidth","proxyButtonsWidth","container","proxyButtonContainer","moreFiltersButtonContainer","handleResize","measureProxyButtons","measureAvailableWidth","leading","trailing","maxWait","props","children","rightPopoverableActions","rightAction","auxiliary","forceShowMorefiltersButton","queryFieldHidden","actionsToRender","getActionsToRender","className","right","shouldRenderMoreFiltersButton","length","RightContainerClassName","RightContainer","RightContainerWithoutMoreFilters","rightMarkup","createElement","popoverFrom","moreFiltersButtonContainerClassname","MoreFiltersButtonContainer","onlyButtonVisible","rightActionMarkup","ref","proxyButtonMarkup","ProxyButtonContainer","map","action","key","activatorButtonFrom","proxy","auxMarkup","AuxiliaryContainer","Fragment","Wrapper","CenterContainer","event","handler","current","tolerance","Array","from","forEach","element","buttonWidth","getBoundingClientRect","width","buttonKey","HTMLElement","dataset","setState","containerWidth","moreFiltersButtonWidth","filtersActionWidth","filterFieldMinWidth","actions","remainingWidth","actionsToReturn","i","actionWidth","push","options","id","undefined","onClick","onAction","disclosure","disabled","content","active","popoverOpen","activator","onClose","preferredAlignment","sectioned","popoverContent"],"mappings":"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","sourcesContent":["import React$1, { Component, createRef } from 'react';\nimport debounce$1 from 'lodash/debounce';\nimport { EventListener as EventListener$1 } from '../../../EventListener/EventListener.js';\nimport { classNames } from '../../../../utilities/css.js';\nimport { Popover as Popover$1 } from '../../../Popover/Popover.js';\nimport { Button as Button$1 } from '../../../Button/Button.js';\nimport styles from './ConnectedFilterControl.scss.js';\nimport { Item as Item$1 } from './components/Item/Item.js';\n\nconst FILTER_FIELD_MIN_WIDTH = 150;\nclass ConnectedFilterControl extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      availableWidth: 0,\n      proxyButtonsWidth: {}\n    };\n    this.container = /*#__PURE__*/createRef();\n    this.proxyButtonContainer = /*#__PURE__*/createRef();\n    this.moreFiltersButtonContainer = /*#__PURE__*/createRef();\n    this.handleResize = debounce$1(() => {\n      this.measureProxyButtons();\n      this.measureAvailableWidth();\n    }, 40, {\n      leading: true,\n      trailing: true,\n      maxWait: 40\n    });\n  }\n\n  componentDidMount() {\n    this.handleResize();\n  }\n\n  render() {\n    const {\n      children,\n      rightPopoverableActions,\n      rightAction,\n      auxiliary,\n      forceShowMorefiltersButton = true,\n      queryFieldHidden\n    } = this.props;\n    const actionsToRender = rightPopoverableActions != null ? this.getActionsToRender(rightPopoverableActions) : [];\n    const className = classNames(styles.ConnectedFilterControl, rightPopoverableActions && styles.right);\n    const shouldRenderMoreFiltersButton = forceShowMorefiltersButton || rightPopoverableActions && rightPopoverableActions.length !== actionsToRender.length;\n    const RightContainerClassName = classNames(styles.RightContainer, !shouldRenderMoreFiltersButton && styles.RightContainerWithoutMoreFilters, queryFieldHidden && styles.queryFieldHidden);\n    const rightMarkup = actionsToRender.length > 0 ? /*#__PURE__*/React$1.createElement(\"div\", {\n      className: RightContainerClassName\n    }, this.popoverFrom(actionsToRender)) : null;\n    const moreFiltersButtonContainerClassname = classNames(styles.MoreFiltersButtonContainer, actionsToRender.length === 0 && styles.onlyButtonVisible);\n    const rightActionMarkup = rightAction ? /*#__PURE__*/React$1.createElement(\"div\", {\n      ref: this.moreFiltersButtonContainer,\n      className: moreFiltersButtonContainerClassname\n    }, shouldRenderMoreFiltersButton && /*#__PURE__*/React$1.createElement(Item$1, null, rightAction)) : null;\n    const proxyButtonMarkup = rightPopoverableActions ? /*#__PURE__*/React$1.createElement(\"div\", {\n      className: styles.ProxyButtonContainer,\n      ref: this.proxyButtonContainer,\n      \"aria-hidden\": true\n    }, rightPopoverableActions.map(action => /*#__PURE__*/React$1.createElement(\"div\", {\n      key: action.key,\n      \"data-key\": action.key\n    }, this.activatorButtonFrom(action, {\n      proxy: true\n    })))) : null;\n    const auxMarkup = auxiliary ? /*#__PURE__*/React$1.createElement(\"div\", {\n      className: styles.AuxiliaryContainer\n    }, auxiliary) : null;\n    return /*#__PURE__*/React$1.createElement(React$1.Fragment, null, proxyButtonMarkup, /*#__PURE__*/React$1.createElement(\"div\", {\n      className: styles.Wrapper\n    }, /*#__PURE__*/React$1.createElement(\"div\", {\n      className: className,\n      ref: this.container\n    }, children ? /*#__PURE__*/React$1.createElement(\"div\", {\n      className: styles.CenterContainer\n    }, /*#__PURE__*/React$1.createElement(Item$1, null, children)) : null, rightMarkup, rightActionMarkup, /*#__PURE__*/React$1.createElement(EventListener$1, {\n      event: \"resize\",\n      handler: this.handleResize\n    })), auxMarkup));\n  }\n\n  measureProxyButtons() {\n    if (this.proxyButtonContainer.current) {\n      const proxyButtonsWidth = {}; // this number is magical, but tweaking it solved the problem of items overlapping\n\n      const tolerance = 78;\n\n      if (this.proxyButtonContainer.current) {\n        Array.from(this.proxyButtonContainer.current.children).forEach(element => {\n          const buttonWidth = element.getBoundingClientRect().width + tolerance;\n          const buttonKey = element instanceof HTMLElement && element.dataset.key;\n\n          if (buttonKey) {\n            proxyButtonsWidth[buttonKey] = buttonWidth;\n          }\n        });\n      }\n\n      this.setState({\n        proxyButtonsWidth\n      });\n    }\n  }\n\n  measureAvailableWidth() {\n    if (this.container.current && this.moreFiltersButtonContainer.current) {\n      const containerWidth = this.container.current.getBoundingClientRect().width;\n      const moreFiltersButtonWidth = this.moreFiltersButtonContainer.current.getBoundingClientRect().width;\n      const filtersActionWidth = 0;\n      const filterFieldMinWidth = this.props.queryFieldHidden ? 0 : FILTER_FIELD_MIN_WIDTH;\n      const availableWidth = containerWidth - filterFieldMinWidth - moreFiltersButtonWidth - filtersActionWidth;\n      this.setState({\n        availableWidth\n      });\n    }\n  }\n\n  getActionsToRender(actions) {\n    let remainingWidth = this.state.availableWidth;\n    const actionsToReturn = [];\n\n    for (let i = 0; remainingWidth > 0 && i < actions.length; i++) {\n      const action = actions[i];\n      const actionWidth = this.state.proxyButtonsWidth[action.key];\n\n      if (actionWidth <= remainingWidth) {\n        actionsToReturn.push(action);\n        remainingWidth -= actionWidth;\n      } else {\n        // When we can't fit an action, we break the loop.\n        // The ones that didn't fit will be accessible through the \"More filters\" button\n        break;\n      }\n    }\n\n    return actionsToReturn;\n  }\n\n  activatorButtonFrom(action, options) {\n    const id = (options == null ? void 0 : options.proxy) ? undefined : `Activator-${action.key}`;\n    return /*#__PURE__*/React$1.createElement(Button$1, {\n      onClick: action.onAction,\n      disclosure: true,\n      disabled: this.props.disabled || action.disabled,\n      id: id\n    }, action.content);\n  }\n\n  popoverFrom(actions) {\n    return actions.map(action => {\n      return /*#__PURE__*/React$1.createElement(Item$1, {\n        key: action.key\n      }, /*#__PURE__*/React$1.createElement(Popover$1, {\n        active: action.popoverOpen,\n        activator: this.activatorButtonFrom(action),\n        onClose: action.onAction,\n        preferredAlignment: \"left\",\n        sectioned: true\n      }, action.popoverContent));\n    });\n  }\n\n}\n\nexport { ConnectedFilterControl };\n"]},"metadata":{},"sourceType":"module"}