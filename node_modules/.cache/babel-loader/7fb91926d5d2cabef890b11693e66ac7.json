{"ast":null,"code":"import _toConsumableArray from \"/home/hoangdev/Desktop/front.test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"/home/hoangdev/Desktop/front.test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport React$1, { useRef, useState, useCallback, useMemo, useEffect } from 'react';\nimport { objectWithoutProperties as _objectWithoutProperties } from '../../../../_virtual/_rollupPluginBabelHelpers.js';\nimport debounce$1 from 'lodash/debounce';\nimport { EventListener as EventListener$1 } from '../../../EventListener/EventListener.js';\nimport { useI18n } from '../../../../utilities/i18n/hooks.js';\nimport { ButtonGroup as ButtonGroup$1 } from '../../../ButtonGroup/ButtonGroup.js';\nimport { SecondaryAction as SecondaryAction$1 } from '../SecondaryAction/SecondaryAction.js';\nimport { MenuGroup as MenuGroup$1 } from '../MenuGroup/MenuGroup.js';\nimport styles from './Actions.scss.js';\nvar ACTION_SPACING = 8;\n\nfunction Actions(_ref) {\n  var _ref$actions = _ref.actions,\n      actions = _ref$actions === void 0 ? [] : _ref$actions,\n      _ref$groups = _ref.groups,\n      groups = _ref$groups === void 0 ? [] : _ref$groups;\n  var i18n = useI18n();\n  var actionsLayoutRef = useRef(null);\n  var menuGroupWidthRef = useRef(0);\n  var availableWidthRef = useRef(0);\n  var actionsAndGroupsLengthRef = useRef(0);\n  var timesMeasured = useRef(0);\n  var actionWidthsRef = useRef([]);\n\n  var _useState = useState(undefined),\n      _useState2 = _slicedToArray(_useState, 2),\n      activeMenuGroup = _useState2[0],\n      setActiveMenuGroup = _useState2[1];\n\n  var _useState3 = useState({\n    showable: [],\n    rolledUp: []\n  }),\n      _useState4 = _slicedToArray(_useState3, 2),\n      measuredActions = _useState4[0],\n      setMeasuredActions = _useState4[1];\n\n  var defaultRollupGroup = {\n    title: i18n.translate('Polaris.Actions.moreActions'),\n    actions: []\n  };\n\n  var lastMenuGroup = _toConsumableArray(groups).pop();\n\n  var lastMenuGroupWidth = _toConsumableArray(actionWidthsRef.current).pop() || 0;\n  var handleActionsOffsetWidth = useCallback(function (width) {\n    actionWidthsRef.current = [].concat(_toConsumableArray(actionWidthsRef.current), [width]);\n  }, []);\n  var handleMenuGroupToggle = useCallback(function (group) {\n    return setActiveMenuGroup(activeMenuGroup ? undefined : group);\n  }, [activeMenuGroup]);\n  var handleMenuGroupClose = useCallback(function () {\n    return setActiveMenuGroup(undefined);\n  }, []);\n  var updateActions = useCallback(function () {\n    var actionsAndGroups = [].concat(_toConsumableArray(actions), _toConsumableArray(groups));\n\n    if (groups.length > 0) {\n      // We don't want to include actions from the last group\n      // since it is always rendered with its own actions\n      actionsAndGroups = _toConsumableArray(actionsAndGroups).slice(0, actionsAndGroups.length - 1);\n    }\n\n    var showable = actionsAndGroups.slice(0, measuredActions.showable.length);\n    var rolledUp = actionsAndGroups.slice(measuredActions.showable.length, actionsAndGroups.length);\n    setMeasuredActions({\n      showable: showable,\n      rolledUp: rolledUp\n    });\n  }, [actions, groups, measuredActions.showable.length]);\n  var measureActions = useCallback(function () {\n    if (actionWidthsRef.current.length === 0 || availableWidthRef.current === 0) {\n      return;\n    }\n\n    var actionsAndGroups = [].concat(_toConsumableArray(actions), _toConsumableArray(groups));\n\n    if (actionsAndGroups.length === 1) {\n      setMeasuredActions({\n        showable: actionsAndGroups,\n        rolledUp: []\n      });\n      return;\n    }\n\n    var currentAvailableWidth = availableWidthRef.current;\n    var newShowableActions = [];\n    var newRolledUpActions = [];\n    actionsAndGroups.forEach(function (action, index) {\n      var canFitAction = actionWidthsRef.current[index] + menuGroupWidthRef.current + ACTION_SPACING + lastMenuGroupWidth <= currentAvailableWidth;\n\n      if (canFitAction) {\n        currentAvailableWidth -= actionWidthsRef.current[index] + ACTION_SPACING * 2;\n        newShowableActions = [].concat(_toConsumableArray(newShowableActions), [action]);\n      } else {\n        currentAvailableWidth = 0; // Find last group if it exists and always render it as a rolled up action below\n\n        if (action === lastMenuGroup) return;\n        newRolledUpActions = [].concat(_toConsumableArray(newRolledUpActions), [action]);\n      }\n    });\n    setMeasuredActions({\n      showable: newShowableActions,\n      rolledUp: newRolledUpActions\n    });\n    timesMeasured.current += 1;\n    actionsAndGroupsLengthRef.current = actionsAndGroups.length;\n  }, [actions, groups, lastMenuGroup, lastMenuGroupWidth]);\n  var handleResize = useMemo(function () {\n    return debounce$1(function () {\n      if (!actionsLayoutRef.current) return;\n      availableWidthRef.current = actionsLayoutRef.current.offsetWidth; // Set timesMeasured to 0 to allow re-measuring\n\n      timesMeasured.current = 0;\n      measureActions();\n    }, 50, {\n      leading: false,\n      trailing: true\n    });\n  }, [measureActions]);\n  useEffect(function () {\n    if (!actionsLayoutRef.current) {\n      return;\n    }\n\n    availableWidthRef.current = actionsLayoutRef.current.offsetWidth;\n\n    if ( // Allow measuring twice\n    // This accounts for the initial paint and re-flow\n    timesMeasured.current >= 2 && [].concat(_toConsumableArray(actions), _toConsumableArray(groups)).length === actionsAndGroupsLengthRef.current) {\n      updateActions();\n      return;\n    }\n\n    measureActions();\n  }, [actions, groups, measureActions, updateActions]);\n  var actionsMarkup = actions.map(function (action) {\n    if (measuredActions.showable.length > 0 || measuredActions.rolledUp.includes(action)) return null;\n\n    var content = action.content,\n        onAction = action.onAction,\n        rest = _objectWithoutProperties(action, [\"content\", \"onAction\"]);\n\n    return /*#__PURE__*/React$1.createElement(SecondaryAction$1, Object.assign({\n      key: content,\n      onClick: onAction\n    }, rest, {\n      getOffsetWidth: handleActionsOffsetWidth\n    }), content);\n  });\n  var rollUppableActionsMarkup = measuredActions.showable.length > 0 ? measuredActions.showable.map(function (action) {\n    return action.content && /*#__PURE__*/React$1.createElement(SecondaryAction$1, Object.assign({\n      key: action.content\n    }, action, {\n      getOffsetWidth: handleActionsOffsetWidth\n    }), action.content);\n  }) : null;\n  var filteredGroups = [].concat(_toConsumableArray(groups), [defaultRollupGroup]).filter(function (group) {\n    return groups.length === 0 ? group : group === lastMenuGroup || !measuredActions.rolledUp.some(function (rolledUpGroup) {\n      return isMenuGroup(rolledUpGroup) && rolledUpGroup.title === group.title;\n    });\n  });\n  var groupsMarkup = filteredGroups.map(function (group) {\n    var title = group.title,\n        groupActions = group.actions,\n        rest = _objectWithoutProperties(group, [\"title\", \"actions\"]);\n\n    var isDefaultGroup = group === defaultRollupGroup;\n    var isLastMenuGroup = group === lastMenuGroup;\n    var finalRolledUpActions = measuredActions.rolledUp.reduce(function (memo, action) {\n      memo.push.apply(memo, _toConsumableArray(isMenuGroup(action) ? action.actions : [action]));\n      return memo;\n    }, []);\n\n    if (!isDefaultGroup && !isLastMenuGroup) {\n      // Render a normal MenuGroup with just its actions\n      return /*#__PURE__*/React$1.createElement(MenuGroup$1, Object.assign({\n        key: title,\n        title: title,\n        active: title === activeMenuGroup,\n        actions: groupActions\n      }, rest, {\n        onOpen: handleMenuGroupToggle,\n        onClose: handleMenuGroupClose,\n        getOffsetWidth: handleActionsOffsetWidth\n      }));\n    } else if (!isDefaultGroup && isLastMenuGroup) {\n      // render the last, rollup group with its actions and finalRolledupActions\n      return /*#__PURE__*/React$1.createElement(MenuGroup$1, Object.assign({\n        key: title,\n        title: title,\n        active: title === activeMenuGroup,\n        actions: [].concat(_toConsumableArray(finalRolledUpActions), _toConsumableArray(groupActions))\n      }, rest, {\n        onOpen: handleMenuGroupToggle,\n        onClose: handleMenuGroupClose,\n        getOffsetWidth: handleActionsOffsetWidth\n      }));\n    } else if (isDefaultGroup && groups.length === 0 && finalRolledUpActions.length) {\n      // Render the default group to rollup into if one does not exist\n      return /*#__PURE__*/React$1.createElement(MenuGroup$1, Object.assign({\n        key: title,\n        title: title,\n        active: title === activeMenuGroup,\n        actions: finalRolledUpActions\n      }, rest, {\n        onOpen: handleMenuGroupToggle,\n        onClose: handleMenuGroupClose,\n        getOffsetWidth: handleActionsOffsetWidth\n      }));\n    }\n  });\n  var groupedActionsMarkup = /*#__PURE__*/React$1.createElement(ButtonGroup$1, {\n    spacing: \"extraTight\"\n  }, rollUppableActionsMarkup, actionsMarkup, groupsMarkup);\n  return /*#__PURE__*/React$1.createElement(\"div\", {\n    className: styles.ActionsLayout,\n    ref: actionsLayoutRef\n  }, groupedActionsMarkup, /*#__PURE__*/React$1.createElement(EventListener$1, {\n    event: \"resize\",\n    handler: handleResize\n  }));\n}\n\nfunction isMenuGroup(actionOrMenuGroup) {\n  return 'title' in actionOrMenuGroup;\n}\n\nexport { Actions };","map":{"version":3,"sources":["/home/hoangdev/Desktop/front.test/node_modules/@shopify/polaris/dist/esm/components/ActionMenu/components/Actions/Actions.js"],"names":["React$1","useRef","useState","useCallback","useMemo","useEffect","objectWithoutProperties","_objectWithoutProperties","debounce$1","EventListener","EventListener$1","useI18n","ButtonGroup","ButtonGroup$1","SecondaryAction","SecondaryAction$1","MenuGroup","MenuGroup$1","styles","ACTION_SPACING","Actions","actions","groups","i18n","actionsLayoutRef","menuGroupWidthRef","availableWidthRef","actionsAndGroupsLengthRef","timesMeasured","actionWidthsRef","undefined","activeMenuGroup","setActiveMenuGroup","showable","rolledUp","measuredActions","setMeasuredActions","defaultRollupGroup","title","translate","lastMenuGroup","pop","lastMenuGroupWidth","current","handleActionsOffsetWidth","width","handleMenuGroupToggle","group","handleMenuGroupClose","updateActions","actionsAndGroups","length","slice","measureActions","currentAvailableWidth","newShowableActions","newRolledUpActions","forEach","action","index","canFitAction","handleResize","offsetWidth","leading","trailing","actionsMarkup","map","includes","content","onAction","rest","createElement","Object","assign","key","onClick","getOffsetWidth","rollUppableActionsMarkup","filteredGroups","filter","some","rolledUpGroup","isMenuGroup","groupsMarkup","groupActions","isDefaultGroup","isLastMenuGroup","finalRolledUpActions","reduce","memo","push","active","onOpen","onClose","groupedActionsMarkup","spacing","className","ActionsLayout","ref","event","handler","actionOrMenuGroup"],"mappings":"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","sourcesContent":["import React$1, { useRef, useState, useCallback, useMemo, useEffect } from 'react';\nimport { objectWithoutProperties as _objectWithoutProperties } from '../../../../_virtual/_rollupPluginBabelHelpers.js';\nimport debounce$1 from 'lodash/debounce';\nimport { EventListener as EventListener$1 } from '../../../EventListener/EventListener.js';\nimport { useI18n } from '../../../../utilities/i18n/hooks.js';\nimport { ButtonGroup as ButtonGroup$1 } from '../../../ButtonGroup/ButtonGroup.js';\nimport { SecondaryAction as SecondaryAction$1 } from '../SecondaryAction/SecondaryAction.js';\nimport { MenuGroup as MenuGroup$1 } from '../MenuGroup/MenuGroup.js';\nimport styles from './Actions.scss.js';\n\nconst ACTION_SPACING = 8;\nfunction Actions({\n  actions = [],\n  groups = []\n}) {\n  const i18n = useI18n();\n  const actionsLayoutRef = useRef(null);\n  const menuGroupWidthRef = useRef(0);\n  const availableWidthRef = useRef(0);\n  const actionsAndGroupsLengthRef = useRef(0);\n  const timesMeasured = useRef(0);\n  const actionWidthsRef = useRef([]);\n  const [activeMenuGroup, setActiveMenuGroup] = useState(undefined);\n  const [measuredActions, setMeasuredActions] = useState({\n    showable: [],\n    rolledUp: []\n  });\n  const defaultRollupGroup = {\n    title: i18n.translate('Polaris.Actions.moreActions'),\n    actions: []\n  };\n  const lastMenuGroup = [...groups].pop();\n  const lastMenuGroupWidth = [...actionWidthsRef.current].pop() || 0;\n  const handleActionsOffsetWidth = useCallback(width => {\n    actionWidthsRef.current = [...actionWidthsRef.current, width];\n  }, []);\n  const handleMenuGroupToggle = useCallback(group => setActiveMenuGroup(activeMenuGroup ? undefined : group), [activeMenuGroup]);\n  const handleMenuGroupClose = useCallback(() => setActiveMenuGroup(undefined), []);\n  const updateActions = useCallback(() => {\n    let actionsAndGroups = [...actions, ...groups];\n\n    if (groups.length > 0) {\n      // We don't want to include actions from the last group\n      // since it is always rendered with its own actions\n      actionsAndGroups = [...actionsAndGroups].slice(0, actionsAndGroups.length - 1);\n    }\n\n    const showable = actionsAndGroups.slice(0, measuredActions.showable.length);\n    const rolledUp = actionsAndGroups.slice(measuredActions.showable.length, actionsAndGroups.length);\n    setMeasuredActions({\n      showable,\n      rolledUp\n    });\n  }, [actions, groups, measuredActions.showable.length]);\n  const measureActions = useCallback(() => {\n    if (actionWidthsRef.current.length === 0 || availableWidthRef.current === 0) {\n      return;\n    }\n\n    const actionsAndGroups = [...actions, ...groups];\n\n    if (actionsAndGroups.length === 1) {\n      setMeasuredActions({\n        showable: actionsAndGroups,\n        rolledUp: []\n      });\n      return;\n    }\n\n    let currentAvailableWidth = availableWidthRef.current;\n    let newShowableActions = [];\n    let newRolledUpActions = [];\n    actionsAndGroups.forEach((action, index) => {\n      const canFitAction = actionWidthsRef.current[index] + menuGroupWidthRef.current + ACTION_SPACING + lastMenuGroupWidth <= currentAvailableWidth;\n\n      if (canFitAction) {\n        currentAvailableWidth -= actionWidthsRef.current[index] + ACTION_SPACING * 2;\n        newShowableActions = [...newShowableActions, action];\n      } else {\n        currentAvailableWidth = 0; // Find last group if it exists and always render it as a rolled up action below\n\n        if (action === lastMenuGroup) return;\n        newRolledUpActions = [...newRolledUpActions, action];\n      }\n    });\n    setMeasuredActions({\n      showable: newShowableActions,\n      rolledUp: newRolledUpActions\n    });\n    timesMeasured.current += 1;\n    actionsAndGroupsLengthRef.current = actionsAndGroups.length;\n  }, [actions, groups, lastMenuGroup, lastMenuGroupWidth]);\n  const handleResize = useMemo(() => debounce$1(() => {\n    if (!actionsLayoutRef.current) return;\n    availableWidthRef.current = actionsLayoutRef.current.offsetWidth; // Set timesMeasured to 0 to allow re-measuring\n\n    timesMeasured.current = 0;\n    measureActions();\n  }, 50, {\n    leading: false,\n    trailing: true\n  }), [measureActions]);\n  useEffect(() => {\n    if (!actionsLayoutRef.current) {\n      return;\n    }\n\n    availableWidthRef.current = actionsLayoutRef.current.offsetWidth;\n\n    if ( // Allow measuring twice\n    // This accounts for the initial paint and re-flow\n    timesMeasured.current >= 2 && [...actions, ...groups].length === actionsAndGroupsLengthRef.current) {\n      updateActions();\n      return;\n    }\n\n    measureActions();\n  }, [actions, groups, measureActions, updateActions]);\n  const actionsMarkup = actions.map(action => {\n    if (measuredActions.showable.length > 0 || measuredActions.rolledUp.includes(action)) return null;\n\n    const {\n      content,\n      onAction\n    } = action,\n          rest = _objectWithoutProperties(action, [\"content\", \"onAction\"]);\n\n    return /*#__PURE__*/React$1.createElement(SecondaryAction$1, Object.assign({\n      key: content,\n      onClick: onAction\n    }, rest, {\n      getOffsetWidth: handleActionsOffsetWidth\n    }), content);\n  });\n  const rollUppableActionsMarkup = measuredActions.showable.length > 0 ? measuredActions.showable.map(action => action.content && /*#__PURE__*/React$1.createElement(SecondaryAction$1, Object.assign({\n    key: action.content\n  }, action, {\n    getOffsetWidth: handleActionsOffsetWidth\n  }), action.content)) : null;\n  const filteredGroups = [...groups, defaultRollupGroup].filter(group => {\n    return groups.length === 0 ? group : group === lastMenuGroup || !measuredActions.rolledUp.some(rolledUpGroup => isMenuGroup(rolledUpGroup) && rolledUpGroup.title === group.title);\n  });\n  const groupsMarkup = filteredGroups.map(group => {\n    const {\n      title,\n      actions: groupActions\n    } = group,\n          rest = _objectWithoutProperties(group, [\"title\", \"actions\"]);\n\n    const isDefaultGroup = group === defaultRollupGroup;\n    const isLastMenuGroup = group === lastMenuGroup;\n    const finalRolledUpActions = measuredActions.rolledUp.reduce((memo, action) => {\n      memo.push(...(isMenuGroup(action) ? action.actions : [action]));\n      return memo;\n    }, []);\n\n    if (!isDefaultGroup && !isLastMenuGroup) {\n      // Render a normal MenuGroup with just its actions\n      return /*#__PURE__*/React$1.createElement(MenuGroup$1, Object.assign({\n        key: title,\n        title: title,\n        active: title === activeMenuGroup,\n        actions: groupActions\n      }, rest, {\n        onOpen: handleMenuGroupToggle,\n        onClose: handleMenuGroupClose,\n        getOffsetWidth: handleActionsOffsetWidth\n      }));\n    } else if (!isDefaultGroup && isLastMenuGroup) {\n      // render the last, rollup group with its actions and finalRolledupActions\n      return /*#__PURE__*/React$1.createElement(MenuGroup$1, Object.assign({\n        key: title,\n        title: title,\n        active: title === activeMenuGroup,\n        actions: [...finalRolledUpActions, ...groupActions]\n      }, rest, {\n        onOpen: handleMenuGroupToggle,\n        onClose: handleMenuGroupClose,\n        getOffsetWidth: handleActionsOffsetWidth\n      }));\n    } else if (isDefaultGroup && groups.length === 0 && finalRolledUpActions.length) {\n      // Render the default group to rollup into if one does not exist\n      return /*#__PURE__*/React$1.createElement(MenuGroup$1, Object.assign({\n        key: title,\n        title: title,\n        active: title === activeMenuGroup,\n        actions: finalRolledUpActions\n      }, rest, {\n        onOpen: handleMenuGroupToggle,\n        onClose: handleMenuGroupClose,\n        getOffsetWidth: handleActionsOffsetWidth\n      }));\n    }\n  });\n  const groupedActionsMarkup = /*#__PURE__*/React$1.createElement(ButtonGroup$1, {\n    spacing: \"extraTight\"\n  }, rollUppableActionsMarkup, actionsMarkup, groupsMarkup);\n  return /*#__PURE__*/React$1.createElement(\"div\", {\n    className: styles.ActionsLayout,\n    ref: actionsLayoutRef\n  }, groupedActionsMarkup, /*#__PURE__*/React$1.createElement(EventListener$1, {\n    event: \"resize\",\n    handler: handleResize\n  }));\n}\n\nfunction isMenuGroup(actionOrMenuGroup) {\n  return 'title' in actionOrMenuGroup;\n}\n\nexport { Actions };\n"]},"metadata":{},"sourceType":"module"}